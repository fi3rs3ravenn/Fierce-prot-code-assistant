# Голосовой AI-ассистент с видеоответами

Проект представляет собой систему голосового взаимодействия, при котором на основе распознанной речи воспроизводится соответствующее видео с синхронизированным звуком. Все действия выполняются локально, без использования внешних API.

---

## Установка зависимостей

1. Установите Python версии 3.10 или выше:  
   https://www.python.org/downloads/

2. Установите зависимости проекта:
   ```bash
   pip install -r requirements.txt
````

Содержимое `requirements.txt`:

```
opencv-python
Pillow
sentence-transformers
sounddevice
vosk
numpy
PyYAML
torch
```

---

## Установка модели VOSK

1. Перейдите на страницу со списком моделей VOSK:
   [https://alphacephei.com/vosk/models](https://alphacephei.com/vosk/models)

2. Скачайте модель `vosk-model-small-ru-0.22`:
   [https://alphacephei.com/vosk/models/vosk-model-small-ru-0.22.zip](https://alphacephei.com/vosk/models/vosk-model-small-ru-0.22.zip)

3. Распакуйте содержимое архива в папку `vosk-model-small-ru-0.22`

4. Убедитесь, что структура проекта включает эту папку на верхнем уровне:

   ```
   /ваш_проект/
   └── vosk-model-small-ru-0.22/
       ├── am
       ├── conf
       └── etc
   ```

---

## Установка ffplay

`ffplay` используется для воспроизведения аудио из видео. Является частью пакета `ffmpeg`.

### Вариант 1: установка через Chocolatey (Windows)

Если у вас установлен Chocolatey:

```bash
choco install ffmpeg
```

### Вариант 2: загрузка вручную

1. Перейдите на сайт [https://ffmpeg.org/download.html](https://ffmpeg.org/download.html)
   Выберите сборку для Windows, например, с сайта [https://www.gyan.dev/ffmpeg/builds/](https://www.gyan.dev/ffmpeg/builds/)

2. Скачайте ZIP-архив, распакуйте его

3. Добавьте путь к папке `bin/` в системную переменную `PATH`. Например:

   ```
   C:\ffmpeg\bin
   ```

4. Проверьте установку:

   ```bash
   ffplay -version
   ```

---

## Структура проекта

```
/ваш_проект/
├── main.py
├── config.yaml
├── questions_video_map.json
├── questions_video_map_extanded.json
├── vosk-model-small-ru-0.22/
├── videos/
│   ├── welcome.mp4
│   ├── main.mp4
│   ├── error.mp4
│   └── question.mp4
├── videos/old/
│   └── *.mp4 (видеоответы)
```

---

## Запуск проекта

Для запуска системы выполните:

```bash
python main.py
```

Откроется окно, в котором:

* Сначала воспроизводится приветственное видео
* После этого в режиме ожидания отображается основное видео (`main.mp4`)
* После получения голосового вопроса запускается соответствующее видео-ответ
* В случае нераспознанного запроса воспроизводится видео `error.mp4`

---

## Примечания

* Видео должны быть в формате `.mp4`, с рекомендованным разрешением 540x960 или 1080x1920 (вертикальный формат)
* Весь процесс обработки речи и видео реализован асинхронно
* Распознавание речи выполняется локально с помощью VOSK
* Сопоставление текста с видео осуществляется с помощью модели Sentence-BERT

---

## Возможные проблемы

1. `ffplay` не запускается:
   Убедитесь, что путь к `ffmpeg/bin` добавлен в системную переменную PATH. Перезапустите систему при необходимости.

2. Микрофон не работает:
   Проверьте, что Python имеет разрешение на доступ к микрофону в системных настройках. Убедитесь, что в `config.yaml` указан корректный `device`.

3. Видео не воспроизводится полностью:
   Убедитесь, что видеофайлы корректны и не повреждены. Используйте видео с установленной частотой кадров (FPS).

---

```

Если нужно, могу также подготовить `setup.bat` или `installer.sh` для автоматической настройки на Windows/Linux.
```